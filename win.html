<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆäº¤è³€å¡ç”Ÿæˆå™¨ - å°ˆæ¥­æ¨£å¼ç‰ˆ</title>
    <style>
        :root { --p-blue: #007aff; }
        body { font-family: "Microsoft JhengHei", sans-serif; background: #f2f2f7; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; }
        
        /* ä¿æŒåŸæœ¬çš„ç”Ÿæˆå™¨ UI ä¸è®Š */
        .ui-panel { background: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 500px; margin-bottom: 20px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .ui-panel h2 { grid-column: span 2; margin: 0 0 10px 0; font-size: 18px; color: #333; }
        .input-group { display: flex; flex-direction: column; }
        .input-group label { font-size: 12px; color: #666; margin-bottom: 4px; }
        .input-group input { padding: 10px; border: 1px solid #ddd; border-radius: 8px; font-size: 14px; outline: none; }
        .input-group input:focus { border-color: var(--p-blue); }
        .full-width { grid-column: span 2; }

        #canvas-container { box-shadow: 0 10px 40px rgba(0,0,0,0.2); line-height: 0; border-radius: 5px; overflow: hidden; }
        canvas { max-width: 100%; height: auto; background: white; }
        .footer-tip { margin-top: 15px; color: #888; font-size: 14px; }
    </style>
</head>
<body>

    <!-- 1. åŸæœ¬çš„ç”Ÿæˆå™¨ä»‹é¢ (ä¿ç•™ ID èˆ‡é‚è¼¯) -->
    <div class="ui-panel">
        <h2>è³€å¡è³‡è¨Šç·¨è¼¯</h2>
        <div class="input-group">
            <label>æ—¥æœŸ (ä¾‹å¦‚ 115/1/16)</label>
            <input type="text" id="date" value="115/1/16">
        </div>
        <div class="input-group">
            <label>å§“å</label>
            <input type="text" id="name" value="è•­ç‰æ˜¥">
        </div>
        <div class="input-group">
            <label>è·ç¨±</label>
            <input type="text" id="title" value="æ¥­å‹™å”ç†">
        </div>
        <div class="input-group">
            <label>ç”¢å“åç¨±</label>
            <input type="text" id="product" value="æµ·å¤–å‚µ">
        </div>
        <div class="input-group full-width">
            <label>æˆäº¤ç¸½é¡ (ç¾å…ƒ)</label>
            <input type="number" id="amount" value="27000">
        </div>
        <div class="input-group">
            <label>æ‰‹æ”¶ (è‡ªå‹•è¨ˆç®—)</label>
            <input type="text" id="hand" readonly style="background:#f9f9f9">
        </div>
        <div class="input-group">
            <label>çé‡‘ (è‡ªå‹•è¨ˆç®—)</label>
            <input type="text" id="bonus" readonly style="background:#f9f9f9">
        </div>
    </div>

    <!-- 2. ç”Ÿæˆåœ–ç‰‡å€åŸŸ -->
    <div id="canvas-container">
        <canvas id="awardCanvas" width="1050" height="735"></canvas>
    </div>
    
    <p class="footer-tip">ğŸ’¡ æ‰‹æ©Ÿé•·æŒ‰åœ–ç‰‡å³å¯å„²å­˜è³€å¡</p>

    <script>
        const canvas = document.getElementById('awardCanvas');
        const ctx = canvas.getContext('2d');

        // åŸæœ¬çš„è¨ˆç®—é‚è¼¯ (è«‹ä¾æ“šæ‚¨çš„å¯¦éš›éœ€æ±‚èª¿æ•´å…¬å¼)
        function doCalculation() {
            const amt = parseFloat(document.getElementById('amount').value) || 0;
            // é€™è£¡æ”¾æ‚¨åŸæœ¬çš„è¨ˆç®—å…¬å¼ï¼Œä»¥ä¸‹ç‚ºç¤ºç¯„
            const handValue = Math.round(amt * 0.5618); 
            const bonusValue = Math.round(handValue * 0.25);

            document.getElementById('hand').value = handValue.toLocaleString();
            document.getElementById('bonus').value = bonusValue.toLocaleString();
        }

        // --- æ ¸å¿ƒç¹ªåœ–å‡½å¼ (å®Œå…¨å°æ¨™ç…§ç‰‡æ¨£å¼) ---
        function draw() {
            const vDate = document.getElementById('date').value;
            const vName = document.getElementById('name').value;
            const vTitle = document.getElementById('title').value;
            const vProduct = document.getElementById('product').value;
            const vAmount = parseFloat(document.getElementById('amount').value || 0).toLocaleString();
            const vHand = document.getElementById('hand').value;
            const vBonus = document.getElementById('bonus').value;

            // 1. èƒŒæ™¯
            ctx.fillStyle = "#ffffff";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // 2. é‡‘è‰²å››è§’è£é£¾ (å›å­—ç´‹)
            drawBorderDeco();

            // 3. å·¦ä¸Šè§’æ—¥æœŸ (é»ƒç¶ è‰²)
            ctx.fillStyle = "#b5c411";
            ctx.font = "bold 44px Arial";
            ctx.textAlign = "left";
            ctx.fillText(vDate, 85, 80);

            // 4. æ›¸æ³•ã€Œè³€ã€å­— (ç´…è‰²å¤§å­—åœ¨èƒŒæ™¯)
            ctx.save();
            ctx.fillStyle = "#e60012";
            ctx.font = "bold 280px 'Kaiti', 'STKaiti', 'æ¨™æ¥·é«”', serif";
            ctx.fillText("è³€", 400, 265);
            ctx.restore();

            // 5. å§“åèˆ‡è·ç¨± (å³ä¸Šè§’é»‘è‰²)
            ctx.textAlign = "right";
            ctx.fillStyle = "#000000";
            ctx.font = "900 115px 'Microsoft JhengHei', sans-serif";
            ctx.fillText(vName, 980, 185);
            ctx.font = "bold 42px 'Microsoft JhengHei', sans-serif";
            ctx.fillText(vTitle, 980, 255);

            // 6. ç”¢å“åç¨±è—è‰²æ–¹æ¡† (æµ·å¤–å‚µ)
            ctx.strokeStyle = "#006699";
            ctx.lineWidth = 1.5;
            ctx.strokeRect(610, 315, 330, 135);
            ctx.textAlign = "center";
            ctx.fillStyle = "#006699";
            ctx.font = "900 90px 'Microsoft JhengHei', sans-serif";
            ctx.fillText(vProduct, 775, 415);
            
            // æ–¹æ¡†å³å´å‚™è¨»å°å­—
            ctx.textAlign = "left";
            ctx.font = "bold 22px 'Microsoft JhengHei', sans-serif";
            ctx.fillText("å…±è¨ˆ2ç­†", 955, 435);

            // 7. æˆäº¤é‡‘é¡ (å·¨å¤§ç´…å­—)
            ctx.textAlign = "right";
            ctx.fillStyle = "#ff0000";
            ctx.font = "900 155px Arial, sans-serif";
            ctx.fillText(vAmount, 940, 595);
            ctx.font = "bold 34px 'Microsoft JhengHei', sans-serif";
            ctx.fillText("ç¾å…ƒ", 995, 620);

            // 8. ä¸‹æ–¹æ•¸æ“šå€ (ç²‰ç´…è‰²)
            ctx.fillStyle = "#ff6699";
            ctx.textAlign = "left";
            ctx.font = "bold 40px 'Microsoft JhengHei', sans-serif";
            ctx.fillText(`æ‰‹æ”¶ï¼š${vHand}å…ƒ`, 550, 685);
            ctx.fillText(`çé‡‘ï¼š${vBonus}å…ƒ`, 550, 730);

            // 9. å·¦å´çç›ƒæ’åœ– (ç”¨åœ–å½¢æ¨¡æ“¬åŸåœ–æ•ˆæœ)
            drawTrophy();

            // 10. å³ä¸‹è§’é ’çå°å°åœ–
            drawPodiumIcon(830, 650);
        }

        function drawBorderDeco() {
            ctx.strokeStyle = "#d4af37";
            ctx.lineWidth = 3.5;
            const s = 65, m = 35;
            const p = [[m, m], [1050-m-s, m], [m, 735-m-s], [1050-m-s, 735-m-s]];
            p.forEach(pos => {
                ctx.strokeRect(pos[0], pos[1], s, s);
                ctx.strokeRect(pos[0]+12, pos[1]+12, s-24, s-24);
            });
        }

        function drawTrophy() {
            // èƒŒæ™¯ç™¼å…‰æ•ˆæœ
            ctx.fillStyle = "#fff4e0";
            ctx.beginPath(); ctx.arc(260, 420, 215, 0, Math.PI*2); ctx.fill();
            // é‡‘è‰²çç›ƒ
            ctx.fillStyle = "#f1c40f";
            ctx.beginPath();
            ctx.moveTo(160, 310); ctx.lineTo(360, 310); ctx.lineTo(320, 510); ctx.lineTo(200, 510);
            ctx.closePath(); ctx.fill();
            // åº•åº§
            ctx.fillStyle = "#5d4037";
            ctx.fillRect(180, 510, 160, 90);
            ctx.fillStyle = "#fff"; ctx.font = "bold 35px Arial"; ctx.textAlign="center";
            ctx.fillText("BEST", 260, 570);
            // æ‰‹éƒ¨ç·šæ¢æ¨¡æ“¬
            ctx.strokeStyle = "#ffccbc"; ctx.lineWidth = 40; ctx.lineCap = "round";
            ctx.beginPath(); ctx.moveTo(120, 550); ctx.lineTo(180, 420); ctx.stroke();
            ctx.beginPath(); ctx.moveTo(400, 550); ctx.lineTo(340, 420); ctx.stroke();
        }

        function drawPodiumIcon(x, y) {
            ctx.fillStyle = "#bdc3c7"; ctx.fillRect(x, y+30, 110, 45); // ç¬¬ä¸€å
            ctx.fillStyle = "#95a5a6"; ctx.fillRect(x-45, y+50, 45, 25); // ç¬¬äºŒå
            ctx.fillRect(x+110, y+55, 45, 20); // ç¬¬ä¸‰å
        }

        // ç›£è½æ‰€æœ‰è¼¸å…¥æ¡†è®Šå‹•
        const inputs = ['date', 'name', 'title', 'product', 'amount'];
        inputs.forEach(id => {
            document.getElementById(id).addEventListener('input', () => {
                doCalculation();
                draw();
            });
        });

        // åˆå§‹é‹è¡Œ
        window.onload = () => {
            doCalculation();
            draw();
        };
    </script>
</body>
</html>