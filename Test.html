<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>元大證券 - 手續費試算器</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root {
            --yuanta-blue: #0056b3;
            --yuanta-dark: #0a0e14;
            --card-bg: #1c222d;
            --input-bg: #252d3a;
            --rise-red: #f23645;
            --fall-green: #089981;
            --accent-gold: #d4af37;
        }
        body { background-color: var(--yuanta-dark); color: white; font-family: sans-serif; }
        .tab-active { color: white; border-bottom: 3px solid var(--yuanta-blue); font-weight: bold; }
        .tab-inactive { color: #848e9c; }
        .input-field { background: var(--input-bg); border: 1px solid #363c4e; border-radius: 8px; color: white; width: 100%; padding: 12px; text-align: right; }
        .result-card { background: var(--card-bg); border-radius: 12px; padding: 16px; border: 1px solid #2d3446; }
        .label-text { color: #848e9c; font-size: 14px; margin-bottom: 4px; display: block; }
    </style>
</head>
<body class="flex justify-center p-4">

    <div class="w-full max-w-md shadow-2xl rounded-2xl overflow-hidden">
        <!-- Header -->
        <div class="p-6 text-center border-b border-gray-800">
            <h1 class="text-xl font-bold tracking-wide">交易手續費試算</h1>
            <p class="text-xs text-gray-500 mt-1">元大證券費率參考版</p>
        </div>

        <!-- Tab Switch -->
        <div class="flex justify-around bg-[#161b22] border-b border-gray-800">
            <button onclick="switchTab('tw')" id="tab-tw" class="py-4 px-8 tab-active">台股交易</button>
            <button onclick="switchTab('us')" id="tab-us" class="py-4 px-8 tab-inactive">美股交易</button>
        </div>

        <div class="p-6 space-y-6">
            
            <!-- 台股試算介面 -->
            <div id="tw-panel" class="space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="label-text">股價 (TWD)</label>
                        <input type="number" id="tw-price" class="input-field" placeholder="0.0" oninput="calculateTW()">
                    </div>
                    <div>
                        <label class="label-text">股數</label>
                        <input type="number" id="tw-qty" class="input-field" value="1000" oninput="calculateTW()">
                    </div>
                </div>

                <div>
                    <label class="label-text">手續費折讓 (例如: 6折請填 6)</label>
                    <div class="relative">
                        <input type="number" id="tw-discount" class="input-field" value="6" oninput="calculateTW()">
                        <span class="absolute left-3 top-3 text-gray-500 text-sm">折</span>
                    </div>
                    <p class="text-[10px] text-gray-500 mt-1">※ 元大基本費率: 0.1425%</p>
                </div>

                <div class="result-card space-y-3">
                    <div class="flex justify-between">
                        <span class="text-gray-400">成交總額</span>
                        <span id="tw-total" class="font-mono font-bold">$0</span>
                    </div>
                    <div class="flex justify-between text-sm">
                        <span class="text-gray-400">手續費 (折後)</span>
                        <span id="tw-fee" class="text-blue-400">$0</span>
                    </div>
                    <div class="flex justify-between text-sm">
                        <span class="text-gray-400">證交稅 (0.3%)</span>
                        <span id="tw-tax" class="text-orange-400">$0</span>
                    </div>
                    <hr class="border-gray-700">
                    <div class="flex justify-between items-center pt-1">
                        <span class="text-sm">買入預計支出</span>
                        <span id="tw-buy-net" class="text-lg text-red-500 font-bold">$0</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-sm">賣出預計實收</span>
                        <span id="tw-sell-net" class="text-lg text-green-500 font-bold">$0</span>
                    </div>
                </div>
            </div>

            <!-- 美股試算介面 -->
            <div id="us-panel" class="hidden space-y-4">
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="label-text">股價 (USD)</label>
                        <input type="number" id="us-price" class="input-field" placeholder="0.0" oninput="calculateUS()">
                    </div>
                    <div>
                        <label class="label-text">股數</label>
                        <input type="number" id="us-qty" class="input-field" value="1" oninput="calculateUS()">
                    </div>
                </div>

                <div class="bg-blue-900/20 border border-blue-500/30 p-3 rounded-lg">
                    <p class="text-xs text-blue-300">元大美股優惠費率：成交金額 0.1%<br>目前設定：無最低手續費限制</p>
                </div>

                <div class="result-card space-y-3">
                    <div class="flex justify-between text-gray-400">
                        <span>成交總額</span>
                        <span id="us-total" class="font-mono font-bold text-white">$0.00</span>
                    </div>
                    <div class="flex justify-between text-sm">
                        <span>手續費 (0.1%)</span>
                        <span id="us-fee" class="text-blue-400">$0.00</span>
                    </div>
                    <hr class="border-gray-700">
                    <div class="flex justify-between items-center pt-2">
                        <span>買入總成本</span>
                        <span id="us-buy-net" class="text-xl text-red-500 font-bold">$0.00</span>
                    </div>
                    <p class="text-[10px] text-gray-500 text-right">※ 美股賣出時另有微量 SEC 費用未列入</p>
                </div>
            </div>

        </div>
    </div>

    <script>
        function switchTab(type) {
            if (type === 'tw') {
                document.getElementById('tw-panel').classList.remove('hidden');
                document.getElementById('us-panel').classList.add('hidden');
                document.getElementById('tab-tw').className = 'py-4 px-8 tab-active';
                document.getElementById('tab-us').className = 'py-4 px-8 tab-inactive';
            } else {
                document.getElementById('tw-panel').classList.add('hidden');
                document.getElementById('us-panel').classList.remove('hidden');
                document.getElementById('tab-tw').className = 'py-4 px-8 tab-inactive';
                document.getElementById('tab-us').className = 'py-4 px-8 tab-active';
            }
        }

        function calculateTW() {
            const price = parseFloat(document.getElementById('tw-price').value) || 0;
            const qty = parseFloat(document.getElementById('tw-qty').value) || 0;
            const discount = parseFloat(document.getElementById('tw-discount').value) || 10;
            
            const total = price * qty;
            // 基本費率 0.1425% (元大)
            let fee = Math.floor(total * 0.001425 * (discount / 10));
            // 台股手續費通常不滿20元以20元計(雖然有些券商會優待，這裡先以元大標準邏輯)
            if (total > 0 && fee < 20) fee = 20; 

            const tax = Math.floor(total * 0.003); // 證交稅 0.3%

            document.getElementById('tw-total').innerText = '$' + total.toLocaleString();
            document.getElementById('tw-fee').innerText = '$' + fee.toLocaleString();
            document.getElementById('tw-tax').innerText = '$' + tax.toLocaleString();
            document.getElementById('tw-buy-net').innerText = '$' + (total + fee).toLocaleString();
            document.getElementById('tw-sell-net').innerText = '$' + (total - fee - tax).toLocaleString();
        }

        function calculateUS() {
            const price = parseFloat(document.getElementById('us-price').value) || 0;
            const qty = parseFloat(document.getElementById('us-qty').value) || 0;
            
            const total = price * qty;
            // 元大美股 0.1%，無低消
            const fee = total * 0.001;

            document.getElementById('us-total').innerText = '$' + total.toLocaleString(undefined, {minimumFractionDigits: 2});
            document.getElementById('us-fee').innerText = '$' + fee.toLocaleString(undefined, {minimumFractionDigits: 2});
            document.getElementById('us-buy-net').innerText = '$' + (total + fee).toLocaleString(undefined, {minimumFractionDigits: 2});
        }
    </script>
</body>
</html>
