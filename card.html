<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2026 ‰ø°Áî®Âç°Ê¨äÁõäÁÆ°ÂÆ∂ - Á≤æÁ∑ªÁæéÂûãÁâà</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap');
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; padding-bottom: 80px; }
        .mode-btn-active { border-color: #4f46e5; background-color: #eef2ff; color: #4f46e5; font-weight: bold; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .recommend-tag { background: linear-gradient(90deg, #4f46e5, #ec4899); }
        .card-shadow { box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.04), 0 8px 10px -6px rgba(0, 0, 0, 0.04); }
        .expiry-badge { background-color: #fee2e2; color: #ef4444; }
    </style>
</head>
<body>

    <!-- Header ËàáÊêúÂ∞ãÊ°Ü (ÂõûÊ≠∏ V4 È¢®Ê†º) -->
    <header class="bg-slate-900 text-white sticky top-0 z-50 p-5 shadow-lg">
        <div class="max-w-md mx-auto">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-xl font-black italic tracking-tighter text-white">CARD NAVI <span class="text-indigo-400">2026</span></h1>
                <span id="todayDisplay" class="text-[9px] bg-slate-800 border border-slate-700 px-2 py-1 rounded-full text-slate-400 font-bold uppercase tracking-widest">January 2026</span>
            </div>
            <div class="relative">
                <i class="fa-solid fa-magnifying-glass absolute left-4 top-1/2 -translate-y-1/2 text-slate-500"></i>
                <input type="text" id="searchInput" oninput="renderCards()" placeholder="ÊêúÂ∞ãÔºöÊó•Êú¨„ÄÅÊ∑òÂØ∂„ÄÅLINE Pay..." 
                    class="w-full bg-slate-800 border-none rounded-2xl py-3 pl-11 pr-4 text-white placeholder-slate-500 focus:ring-2 focus:ring-indigo-500 outline-none transition-all text-sm">
            </div>
        </div>
    </header>

    <main class="max-w-md mx-auto p-4 space-y-6">
        
        <!-- ÊâãÂãïÊ¨äÁõäÂàáÊèõ (V4 È¢®Ê†º) -->
        <div class="bg-white rounded-[32px] shadow-sm border border-gray-100 p-5 space-y-4 card-shadow">
            <div class="flex items-center gap-3 overflow-x-auto no-scrollbar">
                <span class="text-[10px] font-black text-slate-400 whitespace-nowrap uppercase">Cube Mode</span>
                <button onclick="setMode('cube', 'Áé©Êï∏‰Ωç')" id="btn-cube-Áé©Êï∏‰Ωç" class="cube-btn mode-btn-active border px-3 py-1 rounded-full text-[10px] whitespace-nowrap">Áé©Êï∏‰Ωç</button>
                <button onclick="setMode('cube', 'Ê®ÇÈ•óË≥º')" id="btn-cube-Ê®ÇÈ•óË≥º" class="cube-btn border px-3 py-1 rounded-full text-[10px] whitespace-nowrap">Ê®ÇÈ•óË≥º</button>
                <button onclick="setMode('cube', 'Ë∂£ÊóÖË°å')" id="btn-cube-Ë∂£ÊóÖË°å" class="cube-btn border px-3 py-1 rounded-full text-[10px] whitespace-nowrap">Ë∂£ÊóÖË°å</button>
            </div>
            <div class="flex items-center gap-3 overflow-x-auto no-scrollbar">
                <span class="text-[10px] font-black text-slate-400 whitespace-nowrap uppercase">Uni Mode</span>
                <button onclick="setMode('unicard', 'Á∞°ÂñÆÈÅ∏')" id="btn-unicard-Á∞°ÂñÆÈÅ∏" class="uni-btn mode-btn-active border px-3 py-1 rounded-full text-[10px] whitespace-nowrap">Á∞°ÂñÆÈÅ∏</button>
                <button onclick="setMode('unicard', 'Ë®ÇË£ΩÈÅ∏')" id="btn-unicard-Ë®ÇË£ΩÈÅ∏" class="uni-btn border px-3 py-1 rounded-full text-[10px] whitespace-nowrap">Ë®ÇË£ΩÈÅ∏(5%)</button>
            </div>
        </div>

        <!-- Âç°ÁâáÂàóË°® (V4 Êòé‰∫ÆÂúìÊΩ§È¢®) -->
        <div id="cardList" class="space-y-5"></div>

    </main>

    <!-- Ë©¶ÁÆó Modal (V4 Â∫ïÈÉ®ÊäΩÂ±úÈ¢®Ê†º) -->
    <div id="expenseModal" class="fixed inset-0 z-[60] hidden">
        <div class="fixed inset-0 bg-black/40 backdrop-blur-sm" onclick="closeModal()"></div>
        <div class="absolute bottom-0 w-full max-w-md left-1/2 -translate-x-1/2 bg-white rounded-t-[40px] p-8 shadow-2xl transition-transform">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h3 id="modalCardName" class="text-xl font-black text-slate-800"></h3>
                    <p id="modalModeName" class="text-xs font-bold text-indigo-600"></p>
                </div>
                <button onclick="closeModal()" class="w-10 h-10 bg-gray-100 rounded-full flex items-center justify-center text-gray-400"><i class="fa-solid fa-xmark"></i></button>
            </div>
            
            <div class="space-y-6">
                <div class="relative">
                    <span class="absolute left-6 top-1/2 -translate-y-1/2 text-slate-300 font-black text-2xl">$</span>
                    <input type="number" id="inputAmount" oninput="calculateReward()" placeholder="Ëº∏ÂÖ•ÈáëÈ°ç" 
                        class="w-full bg-gray-50 border-none rounded-3xl py-6 pl-12 pr-6 text-4xl font-black focus:ring-4 focus:ring-indigo-500/10 outline-none transition-all">
                </div>

                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-indigo-600 rounded-3xl p-5 text-white">
                        <p class="text-[10px] opacity-60 font-bold uppercase mb-1">È†ê‰º∞ÂõûÈ•ã</p>
                        <p id="calcResult" class="text-2xl font-black">$ 0</p>
                    </div>
                    <div class="bg-slate-900 rounded-3xl p-5 text-white">
                        <p class="text-[10px] opacity-60 font-bold uppercase mb-1">Ââ©È§òÈ°çÂ∫¶</p>
                        <p id="modalRemaining" class="text-xl font-bold text-indigo-300">$ 0</p>
                    </div>
                </div>

                <button onclick="saveExpense()" class="w-full bg-slate-800 text-white py-5 rounded-[24px] font-black text-lg active:scale-95 transition-all shadow-xl shadow-slate-200">
                    Á¢∫Ë™çË®òÂ∏≥
                </button>
            </div>
        </div>
    </div>

    <script>
        const today = new Date();
        let logs = JSON.parse(localStorage.getItem('my_card_logs_2026')) || [];
        let currentTargetCard = null;
        let recommendedMode = null;

        // „Äê2026 ÊúÄÊñ∞Êï¥ÂêàÊ¨äÁõäË≥áÊñôÂ∫´„Äë
        const cardData = {
            richart: {
                name: "Âè∞Êñ∞ Richart Êï¥ÂêàÂç°", bank: "Âè∞Êñ∞ÈäÄË°å", activeMode: "Êï∏‰Ωç/Êµ∑Â§ñ",
                expiry: "2026-03-31", cap: 30303, color: "rose-500",
                note: "Êï∏‰Ωç 3.8% | Êµ∑Â§ñ/Ê©üÁ•® 3% | ÈúÄ Richart Ëá™Êâ£",
                modes: { "Êï∏‰Ωç/Êµ∑Â§ñ": { rate: 3.8, details: "LINE Pay„ÄÅÂÖ®ÊîØ‰ªò„ÄÅÊµ∑Â§ñÁ∂≤Ë≥º„ÄÅËù¶ÁöÆ„ÄÅmomo„ÄÅÊµ∑Â§ñÂØ¶È´î(3%)" } }
            },
            cube: {
                name: "ÂúãÊ≥∞ CUBE Âç°", bank: "ÂúãÊ≥∞‰∏ñËèØ", activeMode: "Áé©Êï∏‰Ωç",
                expiry: "2026-06-30", cap: Infinity, color: "orange-500",
                note: "3% ÁÑ°‰∏äÈôê | ÊØèÊó•ÈúÄÊâãÂãïÂàáÊèõÊ®°Âºè | Â∞èÊ®πÈªûÂõûÈ•ã",
                modes: {
                    "Áé©Êï∏‰Ωç": { rate: 3, details: "Êµ∑Â§ñÁ∂≤Ë≥º„ÄÅËù¶ÁöÆ„ÄÅÈÖ∑Êæé„ÄÅApp Store„ÄÅGoogle Play" },
                    "Ê®ÇÈ•óË≥º": { rate: 3, details: "ÁôæË≤®„ÄÅÂÖ®Âè∞È§êÂª≥„ÄÅUberEats" },
                    "Ë∂£ÊóÖË°å": { rate: 3, details: "Êµ∑Â§ñÂØ¶È´îÂïÜÂ∫ó„ÄÅ‰ΩèÂÆø„ÄÅÊ©üÁ•®„ÄÅUber" }
                }
            },
            legend: {
                name: "ÊòüÂ±ïÂÇ≥Ë™™Â∞çÊ±∫Âç°", bank: "ÊòüÂ±ïÈäÄË°å", activeMode: "10%Âä†Á¢º",
                expiry: "2026-06-30", cap: 11363, color: "slate-700",
                note: "LINE Pay„ÄÅÂ§ñÈÄÅ„ÄÅÂΩ±Èü≥ 10% | Âä†Á¢º‰∏äÈôê 1000 Èªû",
                modes: { "10%Âä†Á¢º": { rate: 10, details: "LINE Pay„ÄÅUberEats„ÄÅNetflix„ÄÅSpotify„ÄÅÈÅäÊà≤ÂÑ≤ÂÄº" } }
            },
            jcb: {
                name: "ÂØåÈÇ¶ JCB (JÂç°)", bank: "ÂØåÈÇ¶ÈäÄË°å", activeMode: "Êó•ÈüìÊóÖÈÅä",
                expiry: "2026-06-30", cap: 20000, color: "sky-500",
                note: "Êó•ÈüìÂØ¶È´î 3% ÁÑ°‰∏äÈôê | Âä†Á¢º 3% ÈúÄÁôªÈåÑÈôêÈáè",
                modes: { "Êó•ÈüìÊóÖÈÅä": { rate: 3, details: "Êó•Êú¨„ÄÅÈüìÂúãÂØ¶È´îÂïÜÂ∫ó‰∫§Êòì" } }
            },
            unicard: {
                name: "ÁéâÂ±± Unicard", bank: "ÁéâÂ±±ÈäÄË°å", activeMode: "Á∞°ÂñÆÈÅ∏",
                expiry: "2026-06-30", cap: 20000, color: "emerald-600",
                note: "ÂõûÈ•ãÁÇ∫ÁéâÂ±± e point | Ë®ÇË£ΩÈÅ∏Âä†Á¢ºÈúÄÈªûÊï∏Ë®ÇÈñ±",
                modes: { "Á∞°ÂñÆÈÅ∏": { rate: 1, details: "‰∏ÄËà¨Ê∂àË≤ª" }, "Ë®ÇË£ΩÈÅ∏": { rate: 5, details: "LINE Pay„ÄÅÂÖ®ÂÆ∂„ÄÅmomo„ÄÅÈÖ∑Êæé" } }
            },
            eco: {
                name: "ÊòüÂ±ïÊ∞∏Á∫åÂç°", bank: "ÊòüÂ±ïÈäÄË°å", activeMode: "‰∏ÄËà¨",
                expiry: "2026-12-31", cap: Infinity, color: "green-500",
                note: "1.5% ‰øùÂ∫ïÂõûÈ•ãÁÑ°‰∏äÈôê",
                modes: { "‰∏ÄËà¨": { rate: 1.5, details: "ÂúãÂÖßÂ§ñ‰∏ÄËà¨Ê∂àË≤ª„ÄÅ‰øùÈö™Ë≤ª" } }
            }
        };

        function setMode(cardKey, modeName) {
            cardData[cardKey].activeMode = modeName;
            const groupClass = cardKey === 'cube' ? 'cube-btn' : 'uni-btn';
            document.querySelectorAll('.' + groupClass).forEach(btn => btn.classList.remove('mode-btn-active'));
            document.getElementById(`btn-${cardKey}-${modeName}`).classList.add('mode-btn-active');
            renderCards();
        }

        function renderCards() {
            const list = document.getElementById('cardList');
            const searchTxt = document.getElementById('searchInput').value.toLowerCase();
            list.innerHTML = '';

            let sortedKeys = Object.keys(cardData).sort((a,b) => getBestRate(b, searchTxt) - getBestRate(a, searchTxt));

            sortedKeys.forEach((key, index) => {
                const card = cardData[key];
                let bestMode = findBestMode(key, searchTxt);
                const activeData = card.modes[bestMode];
                
                // Ê™¢Êü•Âà∞ÊúüÊó•
                const expiryDate = new Date(card.expiry);
                const diffDays = Math.ceil((expiryDate - today) / (1000 * 60 * 60 * 24));
                const isExpiringSoon = diffDays <= 14;

                const used = logs.filter(l => l.cardKey === key && new Date(l.date).getMonth() === today.getMonth()).reduce((s, l) => s + parseFloat(l.amount), 0);
                const remaining = card.cap === Infinity ? 'ÁÑ°‰∏äÈôê' : Math.max(0, card.cap - used);

                const cardDiv = document.createElement('div');
                cardDiv.className = `bg-white rounded-[32px] p-6 relative transition-all card-shadow border border-gray-50 ${index === 0 && searchTxt ? 'ring-4 ring-indigo-500/10 scale-[1.02]' : ''}`;
                cardDiv.innerHTML = `
                    ${index === 0 && searchTxt ? '<span class="recommend-tag absolute top-0 right-0 text-white text-[10px] px-4 py-1.5 rounded-tr-[32px] rounded-bl-2xl font-black tracking-widest uppercase">Best Choice</span>' : ''}
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <div class="flex items-center gap-2 mb-1">
                                <h2 class="text-lg font-black text-slate-800">${card.name}</h2>
                                ${isExpiringSoon ? `<span class="expiry-badge text-[8px] px-2 py-0.5 rounded-full font-black animate-pulse">ÊïàÊúüÂâ© ${diffDays} Â§©</span>` : ''}
                            </div>
                            <p class="text-[9px] text-slate-400 font-bold uppercase tracking-widest">${card.bank}</p>
                        </div>
                        <div class="text-right">
                            <span class="text-3xl font-black text-${card.color}">${activeData.rate}%</span>
                        </div>
                    </div>
                    <div class="bg-gray-50 rounded-2xl p-4 border border-gray-100/50">
                        <p class="text-[11px] text-slate-600 font-bold leading-relaxed"><i class="fa-solid fa-circle-check text-${card.color} mr-2"></i>${activeData.details}</p>
                        ${bestMode !== card.activeMode ? `<p class="text-[9px] text-indigo-600 mt-3 font-black bg-indigo-50 px-2 py-1 rounded-lg inline-block">Âª∫Ë≠∞ÂàáÊèõÔºö${bestMode}</p>` : ''}
                    </div>
                    <div class="flex justify-between items-center mt-4">
                        <span class="text-[10px] text-slate-400 font-bold uppercase tracking-tight">Limit Left: <span class="text-slate-800 font-black">$ ${remaining.toLocaleString()}</span></span>
                        <button onclick="openModal('${key}', '${bestMode}')" class="bg-slate-900 text-white px-5 py-2 rounded-xl font-black text-xs shadow-lg shadow-slate-200">Ë®òÂ∏≥Ë©¶ÁÆó</button>
                    </div>
                    <p class="text-[9px] text-slate-300 mt-4 border-t pt-2 leading-tight italic">üí° ${card.note}</p>
                `;
                list.appendChild(cardDiv);
            });
        }

        function findBestMode(key, txt) {
            const card = cardData[key];
            let best = card.activeMode;
            let max = card.modes[card.activeMode].rate;
            for (let m in card.modes) {
                if (txt && card.modes[m].details.toLowerCase().includes(txt)) {
                    if(card.modes[m].rate >= max) { best = m; max = card.modes[m].rate; }
                }
            }
            return best;
        }

        function getBestRate(key, txt) { return cardData[key].modes[findBestMode(key, txt)].rate; }

        function openModal(key, mode) {
            currentTargetCard = key;
            recommendedMode = mode;
            const card = cardData[key];
            document.getElementById('modalCardName').innerText = card.name;
            document.getElementById('modalModeName').innerText = '2026 ÊñπÊ°àÔºö' + mode + ` (${card.modes[mode].rate}%)`;
            document.getElementById('inputAmount').value = '';
            document.getElementById('calcResult').innerText = '$ 0';
            document.getElementById('modalRemaining').innerText = card.cap === Infinity ? 'ÁÑ°‰∏äÈôê' : '$ ' + (card.cap - getUsedAmount(key)).toLocaleString();
            document.getElementById('expenseModal').classList.remove('hidden');
        }

        function getUsedAmount(key) { return logs.filter(l => l.cardKey === key && new Date(l.date).getMonth() === today.getMonth()).reduce((s, l) => s + parseFloat(l.amount), 0); }

        function calculateReward() {
            const amount = document.getElementById('inputAmount').value || 0;
            const rate = cardData[currentTargetCard].modes[recommendedMode].rate;
            document.getElementById('calcResult').innerText = '$ ' + Math.floor(amount * rate / 100).toLocaleString();
        }

        function saveExpense() {
            const amount = document.getElementById('inputAmount').value;
            if(!amount) return;
            logs.push({ cardKey: currentTargetCard, amount: amount, date: new Date().toISOString() });
            localStorage.setItem('my_card_logs_2026', JSON.stringify(logs));
            closeModal();
            renderCards();
        }

        function closeModal() { document.getElementById('expenseModal').classList.add('hidden'); }

        window.onload = renderCards;
    </script>
</body>
</html>